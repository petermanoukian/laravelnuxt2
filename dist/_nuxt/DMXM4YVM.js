import{u as I,a as L,r as o,k as $,l as D,o as W,w as B,c as r,b as h,d as t,e as z,f as G,m as E,j as S,t as c,g as U,v as V,h as N,_ as J,i}from"./BkfL23Qh.js";import{u as K}from"./C-aMhIz_.js";import{S as Q,M as X}from"./BrcG7ohK.js";import{u as Y}from"./CXs0n1RF.js";import{s as Z}from"./DzOTmNw2.js";import"./DoXzrDiw.js";const ee={class:"bg-gray-100 font-family-karla flex"},te={class:"relative w-full flex flex-col h-screen overflow-y-hidden"},se={class:"w-full h-screen overflow-x-hidden border-t flex flex-col"},oe={class:"w-full flex-grow p-6"},le={class:"flex items-center justify-center bg-gray-100"},ae={class:"fullwidth90 bg-white p-8 shadow-md rounded-lg"},ne={class:"mb-4"},re={class:"mb-4"},ie={key:0},ue={key:1},de={key:2},ce={key:3},me={class:"mb-4"},pe={class:"mb-4"},fe={class:"mb-4"},be={key:0,class:"mt-2 text-sm text-red-600"},ve={key:0,class:"mt-2 text-sm text-red-600"},ge={key:1,class:"mt-2 text-sm text-red-600"},Se={__name:"[id]",setup(ye){const{cats:f,fetchCatsCommon:M}=Y(),P=K(),T=I(),j=L(),A=o(""),m=o(""),b=o(""),d=o(""),l=o(null),v=o(null),g=o(null),y=o(""),x=o(""),w=o(""),_=j.params.id,p=o(null),{$api:R}=$(),F=D().public.apiBaseUrl,O=async()=>{try{const s=await R.get(`${F}/admin/sub/edit/${_}`);A.value=_,p.value=s.data,m.value=p.value.name,b.value=p.value.des,g.value=p.value.img,d.value=p.value.catid,k()}catch(s){console.error("Error fetching item:",s.response?s.response.data:s.message)}},k=()=>{if(d.value&&f.value.length){const s=f.value.find(e=>e.id===d.value);l.value=s||null}},q=async()=>{const{$api:s}=$(),e=D().public.apiBaseUrl,a=new FormData;a.append("name",m.value),a.append("des",b.value),a.append("catid",d.value),a.append("pic1",g.value),v.value&&a.append("pic",v.value);try{const n=await s.post(`${e}/admin/subcat/update/${_}`,a);console.log("SubCategory added successfully:",n.data),w.value="subcategoty updated "+m.value+" ... you will be redircted in a monent ...",setTimeout(()=>{T.push("/admin/subcat/viewsubcat")},300)}catch(n){n.response&&n.response.status===422?x.value=n.response.data.message:x.value="An unexpected error occurred."}},C=s=>{d.value=s?s.id:null};W(async()=>{await P.fetchUser(),O(),M(),k();const s=$refs.multiselect;s&&s.$on("input",C)}),B(f,k),B(l,s=>{console.log("selectedCat changed:",s),C(s)});const H=s=>{const e=s.target.files[0];e&&!e.type.startsWith("image/")?(y.value="Please upload a valid image file.",v.value=null):(y.value="",v.value=e)};return(s,e)=>{var n;const a=J;return i(),r("div",ee,[h(Q),t("div",te,[e[13]||(e[13]=t("header",{class:"w-full items-center bg-white py-2 px-6 hidden sm:flex"},[t("div",{class:"w-1/2"}),t("div",{class:"relative w-1/2 flex justify-end"},"Edit SubCategory")],-1)),h(X),t("div",se,[t("main",oe,[t("div",le,[t("div",ae,[e[11]||(e[11]=t("h1",{class:"text-2xl font-bold mb-4"},"Edit SubCategory",-1)),t("p",ne,[h(a,{to:"/admin/subcat/viewsubcat",class:"widthmax300 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"},{default:z(()=>e[4]||(e[4]=[t("i",{class:"fas fa-align-left mr-3"},null,-1),S("View subcategories")])),_:1})]),t("form",{onSubmit:G(q,["prevent"])},[t("div",re,[e[5]||(e[5]=t("label",{for:"catid",class:"block text-sm font-medium text-gray-700"},"Category",-1)),h(E(Z),{ref:"multiselect",modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=u=>l.value=u),options:E(f),label:"name","track-by":"id",placeholder:"Choose category",searchable:!0,"close-on-select":!0,"allow-empty":!1,class:"mt-1 block w-full",onChange:C},null,8,["modelValue","options"]),S(" catid "+c(d.value)+" ",1),l.value?(i(),r("p",ie,c(l.value.id),1)):(i(),r("p",ue,"Nothin")),(n=l.value)!=null&&n.id?(i(),r("p",de,"Selected Category ID: "+c(l.value.id),1)):(i(),r("p",ce,"No category selected"))]),t("div",me,[e[6]||(e[6]=t("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Title",-1)),U(t("input",{"onUpdate:modelValue":e[1]||(e[1]=u=>m.value=u),type:"text",placeholder:"Name",required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,512),[[V,m.value]])]),t("div",pe,[e[7]||(e[7]=t("label",{for:"des",class:"block text-sm font-medium text-gray-700"}," Short Description",-1)),U(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=u=>b.value=u),class:"mt-1 block w-full px-3 py-3 textareashort border border-gray-300 rounded-md"},null,512),[[V,b.value]])]),t("div",fe,[e[8]||(e[8]=t("label",{for:"pic",class:"block text-sm font-medium text-gray-700"},"Picture",-1)),t("input",{type:"file",onChange:H,class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",accept:"image/*"},null,32),y.value?(i(),r("p",be,c(y.value),1)):N("",!0),e[9]||(e[9]=S(" Old Picture ")),U(t("input",{"onUpdate:modelValue":e[3]||(e[3]=u=>g.value=u),type:"text",readonly:"",placeholder:"Old Picture",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,512),[[V,g.value]])]),e[10]||(e[10]=t("button",{type:"submit",class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"},"Update",-1)),x.value?(i(),r("p",ve,c(x.value),1)):N("",!0),w.value?(i(),r("p",ge,c(w.value),1)):N("",!0)],32)])])]),e[12]||(e[12]=t("footer",{class:"w-full bg-white text-right p-4"},null,-1))])])])}}};export{Se as default};
