import{u as B,a as S,o as U,k as A,l as N,n as x,i as l,c as g,b as y,e as $,j as p,t as b,d as r,h as V,_ as D,w as E,F as h,p as q,q as F,m as j,s as k,r as w}from"./BkfL23Qh.js";import{_ as R}from"./DoXzrDiw.js";import{u as L}from"./C-aMhIz_.js";const O={class:"p-2 border rounded"},z={key:0},I=["src","alt"],J={key:1},M={key:2},T={__name:"ProdAdminSingle",props:{prod:{type:Object,required:!0},config:{type:Object,required:!0}},setup(e){const m=B();S();const u=L();U(async()=>{await u.fetchUser()});const{$api:f}=A();N().public.apiBaseUrl;const o=x(()=>u.user&&u.user.levell===1),P=async t=>{if(confirm("Are you sure you want to delete this "))try{await f.delete(`/admin/deleteprod/${t}`),m.push("/admin/prod/viewprod?message=deleted")}catch(s){console.error("Error deleting :",s.response?s.response.data:s.message),alert("Failed to delete.")}};return(t,a)=>{const s=D;return l(),g("div",O,[y(s,{to:`/admin/prod/detail/${e.prod.id}`},{default:$(()=>[p(" › "+b(e.prod.name),1)]),_:1},8,["to"]),r("p",null," Category: "+b(e.prod.cat.name),1),r("p",null," SubCategory: "+b(e.prod.subcat.name),1),e.prod.img?(l(),g("p",z,[y(s,{to:`/admin/prod/detail/${e.prod.id}`},{default:$(()=>[r("img",{src:`${e.config.public.BaseUrl}/images/prod/thumb/${e.prod.img}`,alt:e.prod.name,class:"mt-2 mb-2 w-32 h-32"},null,8,I)]),_:1},8,["to"])])):(l(),g("p",J,[y(s,{to:`/admin/prod/detail/${e.prod.id}`},{default:$(()=>a[1]||(a[1]=[r("img",{src:R,alt:"Default Picture",class:"mt-2 mb-2 w-32 h-32"},null,-1)])),_:1},8,["to"])])),r("p",null,[y(s,{to:`/admin/prod/edit/${e.prod.id}`},{default:$(()=>a[2]||(a[2]=[p(" › Edit ")])),_:1},8,["to"])]),r("p",null,[y(s,{to:`/admin/prod/addprodbycatidsubid/${e.prod.catid}/${e.prod.subid}`},{default:$(()=>a[3]||(a[3]=[p(" › Add By Cat/Subcategory")])),_:1},8,["to"])]),r("p",null,[y(s,{to:`/admin/prod/viewprodbycatidsubid/${e.prod.catid}/${e.prod.subid}`},{default:$(()=>a[4]||(a[4]=[p(" › View By Cat/Subcategory")])),_:1},8,["to"])]),o.value?(l(),g("p",M,[r("button",{class:"buttonwhite margintop5",onClick:a[0]||(a[0]=C=>P(e.prod.id))}," › Delete ")])):V("",!0)])}}},G={class:"w-full mt-8 mb-8"},H={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-2"},K={class:"bg-gray-100 fullwidth margintopbottom8 pagination"},Q=["disabled"],W=["onClick","disabled"],X=["disabled"],Y={class:"marginleft5"},te={__name:"ProdsAdmin",props:{prods:{type:Array,required:!0},currentPage:{type:Number,required:!0},pageNumbers:{type:Number,required:!0},lastPage:{type:Number,required:!0},changePage:{type:Function,required:!0},catid:{type:Number,required:!1},subid:{type:Number,required:!1}},setup(e){const m=N(),u=e;return E(()=>u.prods,f=>{console.log("Items updated now:",f)}),(f,o)=>{const P=T;return l(),g(h,null,[o[2]||(o[2]=p(" Admin Products ")),r("div",G,[r("div",H,[(l(!0),g(h,null,q(e.prods,t=>(l(),F(P,{key:t.id,prod:t,config:j(m)},null,8,["prod","config"]))),128))])]),r("div",K,[p(" catid : "+b(e.catid)+" ",1),r("button",{onClick:o[0]||(o[0]=t=>e.changePage(e.catid,e.subid,e.currentPage-1)),disabled:e.currentPage===1,class:k(["marginleft5 pager pagerwide",{red:e.currentPage===1,active:e.currentPage===1}])}," << Previous",10,Q),(l(!0),g(h,null,q(e.pageNumbers,t=>(l(),g("span",{key:t,class:"marginleft5"},[r("button",{onClick:a=>e.changePage(e.catid,e.subid,t),class:k(["marginleft5 pager",{red:t===e.currentPage,active:t===e.currentPage}]),disabled:t===e.currentPage},b(t),11,W)]))),128)),r("button",{onClick:o[1]||(o[1]=t=>e.changePage(e.catid,e.subid,e.currentPage+1)),disabled:e.currentPage===e.lastPage,class:k(["marginleft5 pager pagerwide",{red:e.currentPage===e.lastPage,active:e.currentPage===e.lastPage}])}," >> Next",10,X),r("span",Y,"Page "+b(e.currentPage)+" of "+b(e.lastPage),1)])],64)}}};function ae(){const{$api:e}=A(),m=N().public.apiBaseUrl,u=w([]),f=w(1),o=w(1),P=w(8),t=w(0),a=async(n="",d="",v=1)=>{try{const i={page:v,per_page:P.value};n?(i.catid=n,n=n):n="",d?(i.subid=d,d=d):d="";let c="";n!=""&&d!=""?c=await e.get(`${m}/admin/prod/view/${n}/${d}`,{params:i}):n!=""&&d==""?c=await e.get(`${m}/admin/prod/view/${n}`,{params:i}):c=await e.get(`${m}/admin/prod/view`,{params:i}),u.value=c.data.prods.data,f.value=c.data.prods.current_page,o.value=c.data.prods.last_page,t.value=c.data.prods.total,console.log("prod pagination JS "+c.data.prods.data)}catch(i){console.error("Error fetching Products:",i.response?i.response.data:i.message)}},s=(n=null,d=null,v)=>{v>0&&v<=o.value&&a(n,d,v)},C=x(()=>{let n=[];for(let d=1;d<=o.value;d++)n.push(d);return n});return{prods:u,currentPage:f,lastPage:o,perPage:P,totalProds:t,fetchProds:a,changePage:s,pageNumbers:C}}export{te as _,ae as u};
