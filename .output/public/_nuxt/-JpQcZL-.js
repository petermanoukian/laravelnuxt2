import{u as A,a as B,o as U,k as q,l as N,n as x,i as r,c as l,b as y,e as $,j as v,t as b,d as a,h as V,_ as D,w as E,F as w,p as S,q as F,m as j,s as k,r as h}from"./BkfL23Qh.js";import{_ as R}from"./DoXzrDiw.js";import{u as L}from"./C-aMhIz_.js";const O={class:"p-2 border rounded"},z={key:0},I=["src","alt"],M={key:1},T={key:2},G={__name:"SubCatSingleAdmin",props:{subcat:{type:Object,required:!0},config:{type:Object,required:!0}},setup(e){const m=A();B();const o=L();U(async()=>{await o.fetchUser()});const{$api:d}=q();N().public.apiBaseUrl;const c=x(()=>o.user&&o.user.levell===1),f=async t=>{if(confirm("Are you sure you want to delete this subcategory?"))try{await d.delete(`/admin/deletesubcat/${t}`),m.push("/admin/subcat/viewsubcat?message=deleted")}catch(n){console.error("Error deleting category:",n.response?n.response.data:n.message),alert("Failed to delete.")}};return(t,s)=>{const n=D;return r(),l("div",O,[y(n,{to:`/admin/subcat/detail/${e.subcat.id}`},{default:$(()=>[v(" › "+b(e.subcat.name),1)]),_:1},8,["to"]),a("p",null," Category : "+b(e.subcat.cat.name),1),e.subcat.img?(r(),l("p",z,[y(n,{to:`/admin/subcat/detail/${e.subcat.id}`},{default:$(()=>[a("img",{src:`${e.config.public.BaseUrl}/images/subcat/thumb/${e.subcat.img}`,alt:e.subcat.name,class:"mt-2 mb-2 w-32 h-32"},null,8,I)]),_:1},8,["to"])])):(r(),l("p",M,[y(n,{to:`/admin/subcat/detail/${e.subcat.id}`},{default:$(()=>s[1]||(s[1]=[a("img",{src:R,alt:"Default Picture",class:"mt-2 mb-2 w-32 h-32"},null,-1)])),_:1},8,["to"])])),a("p",null,[y(n,{to:`/admin/subcat/edit/${e.subcat.id}`},{default:$(()=>s[2]||(s[2]=[v(" › Edit ")])),_:1},8,["to"])]),a("p",null,[y(n,{to:`/admin/prod/addprodbycatidsubid/${e.subcat.catid}/${e.subcat.id}`},{default:$(()=>s[3]||(s[3]=[v(" › Add Products")])),_:1},8,["to"])]),a("p",null,[y(n,{to:`/admin/prod/viewprodbycatidsubid/${e.subcat.catid}/${e.subcat.id}`},{default:$(()=>[v(" › View Products ( "+b(e.subcat.prods_count)+" ) ",1)]),_:1},8,["to"])]),c.value?(r(),l("p",T,[a("button",{class:"buttonwhite margintop5",onClick:s[0]||(s[0]=C=>f(e.subcat.id))}," › Delete SubCategory ")])):V("",!0)])}}},H={class:"w-full mt-8 mb-8"},J={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-2"},K={class:"bg-gray-100 fullwidth margintopbottom8 pagination"},Q=["disabled"],W=["onClick","disabled"],X=["disabled"],Y={class:"marginleft5"},ee={__name:"SubcatsAdmin",props:{subcats:{type:Array,required:!0},currentPage:{type:Number,required:!0},pageNumbers:{type:Number,required:!0},lastPage:{type:Number,required:!0},changePage:{type:Function,required:!0},catid:{type:Number,required:!1}},setup(e){const m=N(),o=e;return E(()=>o.subcats,d=>{console.log("Items updated now:",d)}),(d,c)=>{const f=G;return r(),l(w,null,[a("div",H,[a("div",J,[(r(!0),l(w,null,S(e.subcats,t=>(r(),F(f,{key:t.id,subcat:t,config:j(m)},null,8,["subcat","config"]))),128))])]),a("div",K,[v(" catid : "+b(e.catid)+" ",1),a("button",{onClick:c[0]||(c[0]=t=>e.changePage(e.catid,e.currentPage-1)),disabled:e.currentPage===1,class:k(["marginleft5 pager pagerwide",{red:e.currentPage===1,active:e.currentPage===1}])}," << Previous",10,Q),(r(!0),l(w,null,S(e.pageNumbers,t=>(r(),l("span",{key:t,class:"marginleft5"},[a("button",{onClick:s=>e.changePage(e.catid,t),class:k(["marginleft5 pager",{red:t===e.currentPage,active:t===e.currentPage}]),disabled:t===e.currentPage},b(t),11,W)]))),128)),a("button",{onClick:c[1]||(c[1]=t=>e.changePage(e.catid,e.currentPage+1)),disabled:e.currentPage===e.lastPage,class:k(["marginleft5 pager pagerwide",{red:e.currentPage===e.lastPage,active:e.currentPage===e.lastPage}])}," >> Next",10,X),a("span",Y,"Page "+b(e.currentPage)+" of "+b(e.lastPage),1)])],64)}}};function te(){const{$api:e}=q(),m=N().public.apiBaseUrl,o=h([]),d=h(1),c=h(1),f=h(8),t=h(0),s=async(u=null,i=1)=>{try{const g={page:i,per_page:f.value};u?(g.catid=u,u=u):u="";let P="";u>0?P=await e.get(`${m}/admin/subcat/view/${u}`,{params:g}):P=await e.get(`${m}/admin/subcat/view`,{params:g}),o.value=P.data.subcats.data,d.value=P.data.subcats.current_page,c.value=P.data.subcats.last_page,t.value=P.data.subcats.total}catch(g){console.error("Error fetching subcategories:",g.response?g.response.data:g.message)}},n=(u=null,i)=>{i>0&&i<=c.value&&s(u,i)},C=x(()=>{let u=[];for(let i=1;i<=c.value;i++)u.push(i);return u});return{subcats:o,currentPage:d,lastPage:c,perPage:f,totalSubcats:t,fetchSubcats:s,changePage:n,pageNumbers:C}}export{ee as _,te as u};
