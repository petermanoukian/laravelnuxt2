import{k as z,l as I,r as a,u as ce,a as me,o as pe,w as _,c as D,b as d,d as s,e as L,f as ge,m as c,j as M,t as R,z as fe,g as F,v as H,h as O,_ as be,i as j}from"./BkfL23Qh.js";import{u as ve,S as ye,_ as xe,a as we}from"./44wPXJ-d.js";import{u as he}from"./C-aMhIz_.js";import{S as Ce,M as ke}from"./BrcG7ohK.js";import{u as Se}from"./CXs0n1RF.js";import{s as q}from"./DzOTmNw2.js";import{u as _e}from"./D1evIxhf.js";import"./DoXzrDiw.js";function Ve(){const{$api:V}=z(),m=I().public.apiBaseUrl,y=a([]),p=a([]),x=a([]);return{taggs:y,taggselects:p,taggnonselects:x,fetchTaggsCommon:async(l=1)=>{try{const o=await V.get(`${m}/admin/tagg/common`);y.value=o.data.data,console.log("composbale line 16"+y.value)}catch(o){console.error("Error fetching items:",o.response?o.response.data:o.message)}},fetchTaggsCommonselect:async(l="")=>{try{const o={};l?(o.prodid=l,l=l):l="";const h=await V.get(`${m}/admin/tagg/commonselected/${l}`,{params1:o});p.value=h.data.data,console.log("composbale line 41"+p.value)}catch(o){console.error("Error fetching items:",o.response?o.response.data:o.message)}},fetchTaggsCommonnonselect:async l=>{try{const o={};l?(o.prodid=l,l=l):l="";const h=await V.get(`${m}/admin/tagg/commonnonselected/${l}`,{params2:o});x.value=h.data.data}catch(o){console.error("Error fetching items:",o.response?o.response.data:o.message)}}}}const Te={class:"bg-gray-100 font-family-karla flex"},Ue={class:"relative w-full flex flex-col h-screen overflow-y-hidden"},Ne={class:"w-full h-screen overflow-x-hidden border-t flex flex-col"},$e={class:"w-full flex-grow p-6"},Ee={class:"flex items-center justify-center bg-gray-100"},Pe={class:"fullwidth90 bg-white p-8 shadow-md rounded-lg"},Be={class:"mb-4"},De={class:"mb-4"},Me={class:"mb-4"},Re={class:"mb-4"},je={class:"mb-4"},Ae={class:"mb-4"},Le={class:"mb-4"},Fe={class:"mb-4"},He={key:0,class:"mt-2 text-sm text-red-600"},Oe={key:0,class:"mt-2 text-sm text-red-600"},qe={key:1,class:"mt-2 text-sm text-red-600"},Ye={__name:"[id]",setup(V){const{cats:m,fetchCatsCommon:y}=Se(),{subcats:p,fetchSubcatsCommon:x}=_e(),{taggselects:w,taggnonselects:J,taggs:K,fetchTaggsCommonselect:l,fetchTaggsCommonnonselect:o,fetchTaggsCommon:h}=Ve(),Q=he(),X=ce(),Y=me(),Z=a(""),C=a(""),g=a(""),b=a(""),T=a(null),U=a(null),N=a(""),$=a(""),A=a(""),E=a(null),k=a(null),ee=a([]),te=a([]),P=a(""),v=a(""),B=a(0),S=Y.params.id;let W=a(null);const f=a(null),{$api:se}=z(),oe=I().public.apiBaseUrl,ae=async()=>{try{const t=await se.get(`${oe}/admin/prod/edit/${S}`);Z.value=S,f.value=t.data,C.value=f.value.name,U.value=f.value.img,g.value=f.value.catid,b.value=f.value.subid,P.value=f.value.des,v.value=f.value.dess}catch(t){console.error("Error fetching item:",t.response?t.response.data:t.message)}},le=async()=>{const{$api:t}=z(),e=I().public.apiBaseUrl,i=w.value.map(u=>u.id),r=new FormData;r.append("name",C.value),r.append("catid",g.value),r.append("subid",b.value),r.append("des",P.value),r.append("dess",v.value),r.append("taggid",i),r.append("pic1",U.value),T.value&&r.append("pic",T.value);try{const u=await t.post(`${e}/admin/prod/update/${S}`,r);console.log("SubCategory added successfully:",u.data),A.value="subcategoty updated "+C.value+" ... you will be redircted in a monent ...",setTimeout(()=>{X.push("/admin/prod/viewprod")},300)}catch(u){u.response&&u.response.status===422?$.value=u.response.data.message:$.value="An unexpected error occurred."}},ne=t=>{g.value=t?t.id:null,B>1&&G(),B.value+=1},re=t=>{b.value=t?t.id:null},G=()=>{b.value=null,k.value=null};pe(async()=>{await Q.fetchUser(),await ae(),await y(),await x(g.value),await l(S),await o(S),await h(),ue(),de(),W.value=ve({content:v.value,extensions:[ye],onUpdate:({editor:t})=>{v.value=t.getHTML()}})});const ue=()=>{if(g.value&&m.value.length){const t=Number(g.value),e=m.value.find(i=>i.id===t);E.value=e||null}},de=()=>{if(b.value&&p.value.length){const t=Number(b.value),e=p.value.find(i=>i.id===t);k.value=e||null}};_(B,t=>{t>1&&G()}),_(g,t=>{x(t)}),_(E,t=>{console.log("selectedCat changed:",t),ne(t)}),_(k,t=>{console.log("selectedCat changed:",t),re(t)});const ie=t=>{const e=t.target.files[0];e&&!e.type.startsWith("image/")?(N.value="Please upload a valid image file.",T.value=null):(N.value="",T.value=e)};return _(te,t=>{ee.value=t.map(e=>e.id)}),(t,e)=>{const i=be,r=we,u=xe;return j(),D("div",Te,[d(Ce),s("div",Ue,[e[20]||(e[20]=s("header",{class:"w-full items-center bg-white py-2 px-6 hidden sm:flex"},[s("div",{class:"w-1/2"}),s("div",{class:"relative w-1/2 flex justify-end"}," Edit Product ")],-1)),d(ke),s("div",Ne,[s("main",$e,[s("div",Ee,[s("div",Pe,[e[18]||(e[18]=s("h1",{class:"text-2xl font-bold mb-4"},"Edit Product ",-1)),s("p",Be,[d(i,{to:"/admin/subcat/viewsubcat",class:"widthmax300 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"},{default:L(()=>e[7]||(e[7]=[s("i",{class:"fas fa-align-left mr-3"},null,-1),M("View Subcategories")])),_:1}),d(i,{to:"/admin/prod/viewprod",class:"marginleft8 widthmax300 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"},{default:L(()=>e[8]||(e[8]=[s("i",{class:"fas fa-align-left mr-3"},null,-1),M("View Products")])),_:1})]),s("form",{onSubmit:ge(le,["prevent"])},[s("div",De,[e[9]||(e[9]=s("label",{for:"catid",class:"block text-sm font-medium text-gray-700"},"Category",-1)),d(c(q),{ref:"multiselectcat",modelValue:E.value,"onUpdate:modelValue":e[0]||(e[0]=n=>E.value=n),options:c(m),label:"name","track-by":"id",placeholder:"Choose category",searchable:!0,"close-on-select":!0,"allow-empty":!1,class:"mt-1 block w-full"},null,8,["modelValue","options"]),M(" loader : "+R(B.value),1)]),s("div",Me,[e[10]||(e[10]=s("label",{for:"subid",class:"block text-sm font-medium text-gray-700"},"SubCategory",-1)),d(c(q),{ref:"multiselectsubcat",modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=n=>k.value=n),options:c(p),label:"name","track-by":"id",placeholder:"Choose subcategory",searchable:!0,"close-on-select":!0,"allow-empty":!1,class:"mt-1 block w-full"},null,8,["modelValue","options"])]),s("div",Re,[e[11]||(e[11]=s("label",{for:"taggid",class:"block text-sm font-medium text-gray-700"}," Tags ",-1)),d(c(q),{modelValue:c(w),"onUpdate:modelValue":e[2]||(e[2]=n=>fe(w)?w.value=n:null),options:c(K),label:"name","track-by":"id",placeholder:"Choose tags",searchable:!0,"close-on-select":!0,"allow-empty":!0,class:"mt-1 block w-full",multiple:!0},null,8,["modelValue","options"])]),s("div",je,[e[12]||(e[12]=s("label",{for:"name",class:"block text-sm font-medium text-gray-700"}," Name",-1)),F(s("input",{"onUpdate:modelValue":e[3]||(e[3]=n=>C.value=n),type:"text",placeholder:"Name",required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none"},null,512),[[H,C.value]])]),s("div",Ae,[e[13]||(e[13]=s("label",{for:"des",class:"block text-sm font-medium text-gray-700"}," Short Description",-1)),F(s("textarea",{"onUpdate:modelValue":e[4]||(e[4]=n=>P.value=n),type:"text",class:"mt-1 block w-full px-3 py-3 textareashort border border-gray-300 rounded-md"},null,512),[[H,P.value]])]),s("div",Le,[e[14]||(e[14]=s("label",{for:"dess",class:"block text-sm font-medium text-gray-700"}," Long Description",-1)),d(u,null,{default:L(()=>[d(r,{modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=n=>v.value=n),class:"textarealongborder",editor:c(W)},null,8,["modelValue","editor"])]),_:1})]),s("div",Fe,[e[15]||(e[15]=s("label",{for:"pic",class:"block text-sm font-medium text-gray-700"},"Picture",-1)),s("input",{type:"file",onChange:ie,class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",accept:"image/*"},null,32),N.value?(j(),D("p",He,R(N.value),1)):O("",!0),e[16]||(e[16]=M(" Old Picture ")),F(s("input",{"onUpdate:modelValue":e[6]||(e[6]=n=>U.value=n),type:"text",readonly:"",placeholder:"Old Picture",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,512),[[H,U.value]])]),e[17]||(e[17]=s("button",{type:"submit",class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"},"Update",-1)),$.value?(j(),D("p",Oe,R($.value),1)):O("",!0),A.value?(j(),D("p",qe,R(A.value),1)):O("",!0)],32)])])]),e[19]||(e[19]=s("footer",{class:"w-full bg-white text-right p-4"},null,-1))])])])}}};export{Ye as default};
