import{u as q,a as R,o as V,k as B,l as A,n as E,i,c as g,b as d,e as v,j as w,t as b,d as t,h as C,_ as U,w as N,F as x,p as S,q as I,m as p,s as k,r as $,P as M}from"./BkfL23Qh.js";import{_ as O}from"./DoXzrDiw.js";import{u as j}from"./C-aMhIz_.js";import{S as z,M as H}from"./BrcG7ohK.js";const T={class:"p-2 border rounded"},G={key:0},J=["src","alt"],K={key:1},Q={key:2},W={__name:"CatSingleAdmin",props:{cat:{type:Object,required:!0},config:{type:Object,required:!0}},setup(e){const P=q();R();const m=j();V(async()=>{await m.fetchUser()});const{$api:f}=B();A().public.apiBaseUrl;const l=E(()=>m.user&&m.user.levell===1),y=async a=>{if(confirm("Are you sure you want to delete this category?"))try{await f.delete(`/admin/deletecat/${a}`),P.push("/admin/cat/viewcat?message=deleted")}catch(n){console.error("Error deleting category:",n.response?n.response.data:n.message),alert("Failed to delete the category.")}};return(a,s)=>{const n=U;return i(),g("div",T,[d(n,{to:`/admin/cat/detail/${e.cat.id}`},{default:v(()=>[w(" › "+b(e.cat.name)+" "+b(e.cat.id),1)]),_:1},8,["to"]),e.cat.img?(i(),g("p",G,[d(n,{to:`/admin/cat/detail/${e.cat.id}`},{default:v(()=>[t("img",{src:`${e.config.public.BaseUrl}/images/cat/thumb/${e.cat.img}`,alt:e.cat.name,class:"mt-2 mb-2 w-32 h-32"},null,8,J)]),_:1},8,["to"])])):(i(),g("p",K,[d(n,{to:`/admin/cat/detail/${e.cat.id}`},{default:v(()=>s[1]||(s[1]=[t("img",{src:O,alt:"Default Picture",class:"mt-2 mb-2 w-32 h-32"},null,-1)])),_:1},8,["to"])])),t("p",null,[d(n,{to:`/admin/cat/edit/${e.cat.id}`},{default:v(()=>s[2]||(s[2]=[w(" › Edit ")])),_:1},8,["to"])]),t("p",null,[d(n,{to:`/admin/subcat/viewsubcatbycatid/${e.cat.id}`},{default:v(()=>[w(" › View Subcategories ( "+b(e.cat.subcats_count)+" ) ",1)]),_:1},8,["to"])]),t("p",null,[d(n,{to:`/admin/subcat/addsubcat/${e.cat.id}`},{default:v(()=>s[3]||(s[3]=[w(" › Add Subcategories ")])),_:1},8,["to"])]),t("p",null,[d(n,{to:`/admin/prod/viewprodbycatid/${e.cat.id}`},{default:v(()=>[w(" › View Products ( "+b(e.cat.prods_count)+" ) ",1)]),_:1},8,["to"])]),t("p",null,[d(n,{to:`/admin/prod/addprodbycatid/${e.cat.id}`},{default:v(()=>s[4]||(s[4]=[w(" › Add Products ")])),_:1},8,["to"])]),l.value?(i(),g("p",Q,[t("button",{onClick:s[0]||(s[0]=h=>y(e.cat.id)),class:"buttonwhite margintop5"}," › Delete Category ")])):C("",!0)])}}},X={class:"w-full mt-8 mb-8"},Y={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-2"},Z={class:"bg-gray-100 fullwidth margintopbottom8 pagination"},_=["disabled"],ee=["onClick","disabled"],te=["disabled"],ae={class:"marginleft5"},se={__name:"CatsAdmin",props:{cats:{type:Array,required:!0},currentPage:{type:Number,required:!0},pageNumbers:{type:Number,required:!0},lastPage:{type:Number,required:!0},changePage:{type:Function,required:!0}},setup(e){const P=A(),m=e;return N(()=>m.cats,f=>{console.log("Items updated now:",f)}),(f,l)=>{const y=W;return i(),g(x,null,[t("div",X,[t("div",Y,[(i(!0),g(x,null,S(e.cats,a=>(i(),I(y,{key:a.id,cat:a,config:p(P)},null,8,["cat","config"]))),128))])]),t("div",Z,[t("button",{onClick:l[0]||(l[0]=a=>e.changePage(e.currentPage-1)),disabled:e.currentPage===1,class:k(["marginleft5 pager pagerwide",{red:e.currentPage===1,active:e.currentPage===1}])}," << Previous",10,_),(i(!0),g(x,null,S(e.pageNumbers,a=>(i(),g("span",{key:a,class:"marginleft5"},[t("button",{onClick:s=>e.changePage(a),class:k(["marginleft5 pager",{red:a===e.currentPage,active:a===e.currentPage}]),disabled:a===e.currentPage},b(a),11,ee)]))),128)),t("button",{onClick:l[1]||(l[1]=a=>e.changePage(e.currentPage+1)),disabled:e.currentPage===e.lastPage,class:k(["marginleft5 pager pagerwide",{red:e.currentPage===e.lastPage,active:e.currentPage===e.lastPage}])}," >> Next",10,te),t("span",ae,"Page "+b(e.currentPage)+" of "+b(e.lastPage),1)])],64)}}};function oe(){const{$api:e}=B(),P=A().public.apiBaseUrl,m=$([]),f=$(1),l=$(1),y=$(12),a=$(0),s=async(o=1)=>{try{const r=await e.get(`${P}/admin/cat/view?page=${o}&per_page=${y.value}`);m.value=r.data.data,f.value=r.data.current_page,l.value=r.data.last_page,a.value=r.data.total}catch(r){console.error("Error fetching items:",r.response?r.response.data:r.message)}},n=o=>{o>0&&o<=l.value&&(f.value=o,s(o))},h=E(()=>{let o=[];for(let r=1;r<=l.value;r++)o.push(r);return o});return{cats:m,currentPage:f,lastPage:l,perPage:y,totalCats:a,fetchCats:s,changePage:n,pageNumbers:h}}const ne={class:"bg-gray-100 font-family-karla flex"},re={class:"relative w-full flex flex-col h-screen overflow-y-hidden"},le={class:"w-full h-screen overflow-x-hidden border-t flex flex-col"},ce={class:"w-full flex-grow p-6"},ie={class:"text-2xl font-bold mb-4"},ue={key:0,class:"bold red font18"},de={key:1,class:"bold red font18",id:"scrollhere"},he={__name:"viewcat",setup(e){const{cats:P,currentPage:m,lastPage:f,changePage:l,pageNumbers:y,fetchCats:a}=oe(),s=$(0),n=q(),h=R(),o=$(h.query.message||""),r=j();V(async()=>{if(await r.fetchUser(),a(),o.value){const u=document.getElementById("scrollhere");u&&u.scrollIntoView({behavior:"smooth"})}});const D=()=>{console.log("Route refresh attempt"),s.value+=1,console.log("key value"+s.value),console.log(h.path),n.replace({path:h.path}).then(()=>{console.log("Navigation ok, route replaced to "+h.path)}).catch(u=>{console.error("Navigation error:",u)}),console.log("end"),a()};return N(h,async(u,c)=>{console.log("Route changed from",c.path,"to",u.path),await a()}),N(()=>h.query.message,u=>{if(o.value=u,o.value){const c=document.getElementById("scrollhere");c&&c.scrollIntoView({behavior:"smooth"})}}),(u,c)=>{const F=U,L=se;return i(),g("div",ne,[d(z),t("div",re,[c[3]||(c[3]=t("header",{class:"w-full items-center bg-white py-2 px-6 hidden sm:flex"},[t("div",{class:"w-1/2"}),t("div",{class:"relative w-1/2 flex justify-end"}," View Categories ")],-1)),d(H),t("div",le,[t("main",ce,[t("h1",ie,[c[1]||(c[1]=w("View Categories ")),d(F,{to:"/admin/cat/addcategory",class:"widthmax300 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"},{default:v(()=>c[0]||(c[0]=[t("i",{class:"fas fa-align-left mr-3"},null,-1),w("Add Category")])),_:1})]),o.value?(i(),g("div",ue,b(o.value),1)):C("",!0),(i(),I(L,{cats:p(P),currentPage:p(m),lastPage:p(f),changePage:p(l),pageNumbers:p(y),key:s.value.value},null,8,["cats","currentPage","lastPage","changePage","pageNumbers"])),o.value?(i(),g("div",de,b(o.value),1)):C("",!0),t("p",null,"Current Route: "+b((u._.provides[M]||u.$route).path),1),t("button",{onClick:D,class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-3"},"Refresh Route")]),c[2]||(c[2]=t("footer",{class:"w-full bg-white text-right p-4"},null,-1))])])])}}};export{he as default};
