import{u as ve,_ as fe}from"./C5NpTOTi.js";import{w as J,i as l,c as r,d as e,F as P,p as S,b as w,e as U,j as C,t as i,m as c,s as z,l as K,_ as be,k as oe,r as m,n as pe,u as he,a as ye,o as xe,f as O,g as F,y as Y,v as te,h as G,q as ae,P as se}from"./BkfL23Qh.js";import{_ as we}from"./DoXzrDiw.js";import{u as Pe}from"./C-aMhIz_.js";import{S as $e,M as ke}from"./BrcG7ohK.js";import"./B7UVwuT_.js";import{u as Se}from"./CXs0n1RF.js";import{u as Ce}from"./D1evIxhf.js";import"./DzOTmNw2.js";const Ne={class:"w-full mt-8 mb-8"},Ve={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-2"},qe={key:0},Be=["src","alt"],Re={key:1},Ue={class:"bg-gray-100 fullwidth margintopbottom8"},Ae=["disabled"],Ee=["onClick","disabled"],Me=["disabled"],Fe={class:"marginleft5"},De={__name:"Prodsearch",props:{prodsx:{type:Array,required:!0},currentPagex:{type:Number,required:!0},pageNumbersx:{type:Number,required:!0},lastPagex:{type:Number,required:!0},changePagex:{type:Function,required:!0},searchx:{type:String,required:!1},catid:{type:Number,required:!1},subid:{type:Number,required:!1}},setup(a){const N=K(),V=a;return J(()=>V.prodsx,h=>{console.log("Items updated now:",h)}),(h,u)=>{const f=be;return l(),r(P,null,[e("div",Ne,[e("div",Ve,[(l(!0),r(P,null,S(a.prodsx,o=>(l(),r("div",{key:o.id,class:"p-2 border rounded"},[w(f,{to:`/admin/prod/detail/${o.id}`},{default:U(()=>[C(" › "+i(o.name),1)]),_:2},1032,["to"]),e("p",null," Category : "+i(o.cat.name),1),e("p",null," SubCategory : "+i(o.subcat.name),1),o.img?(l(),r("p",qe,[w(f,{to:`/admin/prod/detail/${o.id}`},{default:U(()=>[e("img",{src:`${c(N).public.BaseUrl}/images/prod/thumb/${o.img}`,alt:o.name,class:"mt-2 mb-2 w-32 h-32"},null,8,Be)]),_:2},1032,["to"])])):(l(),r("p",Re,[w(f,{to:`/admin/prod/detail/${o.id}`},{default:U(()=>u[2]||(u[2]=[e("img",{src:we,alt:"Default Picture",class:"mt-2 mb-2 w-32 h-32"},null,-1)])),_:2},1032,["to"])])),e("p",null,[w(f,{to:`/admin/prod/edit/${o.id}`},{default:U(()=>u[3]||(u[3]=[C(" › Edit ")])),_:2},1032,["to"])]),e("p",null,[w(f,{to:`/admin/prod/addprodbycatidsubid/${o.catid}/${o.subid}`},{default:U(()=>u[4]||(u[4]=[C(" › Add Products")])),_:2},1032,["to"])]),e("p",null,[w(f,{to:`/admin/prod/viewprodbycatidsubid/${o.catid}/${o.subid}`},{default:U(()=>u[5]||(u[5]=[C(" › View Products")])),_:2},1032,["to"])])]))),128))])]),e("div",Ue,[C(" catid : "+i(a.catid)+" ",1),e("button",{onClick:u[0]||(u[0]=o=>a.changePagex(a.searchx,a.catid,a.subid,a.currentPagex-1)),disabled:a.currentPagex===1,class:z(["marginleft5",{red:a.currentPagex===1,active:a.currentPagex===1}])}," << Previous",10,Ae),(l(!0),r(P,null,S(a.pageNumbersx,o=>(l(),r("span",{key:o,class:"marginleft5"},[e("button",{onClick:A=>a.changePagex(a.searchx,a.catid,a.subid,o),class:z({red:o===a.currentPagex,active:o===a.currentPagex}),disabled:o===a.currentPagex},i(o),11,Ee)]))),128)),e("button",{onClick:u[1]||(u[1]=o=>a.changePagex(a.searchx,a.catid,a.subid,h.currentPage+1)),disabled:a.currentPagex===a.lastPagex,class:z(["marginleft5",{red:a.currentPagex===a.lastPagex,active:a.currentPagex===h.lastPage}])}," >> Next",10,Me),e("span",Fe,"Page "+i(a.currentPagex)+" of "+i(a.lastPagex),1)])],64)}}};function He(){const{$api:a}=oe(),N=K().public.apiBaseUrl,V=m([]),h=m(1),u=m(1),f=m(9),o=m(0),A=async(g="",v="",b="",$=1)=>{try{const p={page:$,per_page:f.value};g?(p.searchx=g,g=g):g="",v?(p.catid=v,v=v):v="",b?(p.subid=b,b=b):b="";const q=await a.get(`${N}/admin/prod/search/${g}/${v}/${b}`,{params:p});V.value=q.data.prods.data,h.value=q.data.prods.current_page,u.value=q.data.prods.last_page,o.value=q.data.prods.total}catch(p){console.error("Error fetching subcategories:",p.response?p.response.data:p.message)}},I=(g=null,v=null,b=null,$)=>{$>0&&$<=u.value&&A(g,v,b,$)},j=pe(()=>{let g=[];for(let v=1;v<=u.value;v++)g.push(v);return g});return{prodsx:V,currentPagex:h,lastPagex:u,perPagex:f,totalProdsx:o,fetchsearchProds:A,changePagex:I,pageNumbersx:j}}const Ie={class:"bg-gray-100 font-family-karla flex"},je={class:"relative w-full flex flex-col h-screen overflow-y-hidden"},Le={class:"w-full h-screen overflow-x-hidden border-t flex flex-col"},Qe={class:"w-full flex-grow p-6"},Te={class:"fullwidth mb-2"},ze={class:"halfwidth48 floatleft"},Oe=["value"],Ye={class:"halfwidth48 floatleft"},Ge=["value"],Je=["value"],Ke={class:"fullwidth mt-6"},We={class:"halfwidth48 floatleft"},Xe={key:0,class:"suggestions-list marginleft25"},Ze=["onClick"],_e={key:1,class:"red"},et={class:"halfwidth48 floatleft"},tt={key:0,class:"suggestions-list marginleft25"},at=["onClick"],st={class:"fullwidth mt-3"},ot={key:0},lt={key:1},ft={__name:"viewprod",setup(a){const{cats:N,fetchCatsCommon:V}=Se(),{subcats:h,fetchSubcatsCommon:u}=Ce(),{prods:f,currentPage:o,lastPage:A,changePage:I,pageNumbers:j,fetchProds:g}=ve(),{prodsx:v,currentPagex:b,lastPagex:$,changePagex:p,pageNumbersx:q,fetchsearchProds:W}=He(),D=he(),L=ye(),{$api:X}=oe(),Z=K().public.apiBaseUrl,E=m(null),k=m(null),M=m(null),n=m("");var H=m("");const B=m(0),y=m([]),x=m([]),R=m(""),Q=async()=>{n.value!=""?(B.value=1,H.value=n.value,await W(n.value),R.value="",y.value="",x.value=""):R.value="Your seach is empty"},le=async()=>{n.value!=""?(B.value=1,H.value=n.value,await W(n.value),R.value="",y.value="",x.value=""):R.value=""},re=Pe();xe(async()=>{await re.fetchUser(),await g(),await V(),await u()});const T=m(0),_=()=>{T.value+=1,B.value=0,D.replace({path:L.path}).then(()=>{console.log("Navigation ok, route replaced to "+L.path)}).catch(d=>{console.error("Navigation error:",d)}),g(),E.value=null,k.value=null,M.value=null,n.value="",H.value="",B.value=0,y.value=[],x.value=[]};J(L,async(d,t)=>{console.log("Route changed from",t.path,"to",d.path),g()});const ne=()=>{E.value&&D.push(`/admin/prod/viewprodbycatid/${E.value}`)},ue=()=>{k.value&&(M.value?D.push(`/admin/prod/viewprodbycatidsubid/${k.value}/${M.value}`):D.push(`/admin/prod/viewprodbycatid/${k.value}`))};J(n,d=>{Q()});const de=async()=>{if(n.value.length<2){y.value=[];return}try{const d=await X.get(`${Z}/admin/prod/suggestions/${n.value}`,{params:{query:n.value}});y.value=d.data}catch(d){console.error("Error fetching suggestions:",d)}},ie=async()=>{if(n.value.length<2){x.value=[];return}try{const d=await X.get(`${Z}/admin/prod/suggestions/${n.value}`,{params:{query:n.value}});x.value=d.data}catch(d){console.error("Error fetching suggestions:",d)}},ee=d=>{n.value=d.name,y.value=[],x.value=[],Q()};return(d,t)=>{const ce=fe,ge=De;return l(),r("div",Ie,[w($e),e("div",je,[t[21]||(t[21]=e("header",{class:"w-full items-center bg-white py-2 px-6 hidden sm:flex"},[e("div",{class:"w-1/2"}),e("div",{class:"relative w-1/2 flex justify-end"}," View All products ")],-1)),w(ke),e("div",Le,[e("main",Qe,[e("div",Te,[e("div",ze,[t[9]||(t[9]=e("h1",{class:"text-2xl font-bold mb-4"},"View By Category",-1)),e("form",{onSubmit:O(ne,["prevent"]),class:"floatleft"},[t[7]||(t[7]=e("label",{for:"catSelect"},"Select Category:",-1)),F(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>E.value=s),id:"catSelect",required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm width400px"},[t[6]||(t[6]=e("option",{value:"null",disabled:""}," Choose category",-1)),(l(!0),r(P,null,S(c(N),s=>(l(),r("option",{key:s.id,value:s.id},i(s.name),9,Oe))),128))],512),[[Y,E.value]]),t[8]||(t[8]=e("button",{type:"submit",class:"mt-3 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none width400px"}," View Products By category",-1))],32)]),e("div",Ye,[t[15]||(t[15]=e("h1",{class:"text-2xl font-bold mb-4"},"View By Category and Subcategory",-1)),e("form",{onSubmit:O(ue,["prevent"]),class:"floatleft"},[t[12]||(t[12]=e("label",{for:"catSelect2"},"Select Category:",-1)),F(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>k.value=s),id:"catSelect2",onChange:t[2]||(t[2]=s=>c(u)(k.value)),required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm width400px"},[t[10]||(t[10]=e("option",{value:"null",disabled:""}," Choose Category",-1)),(l(!0),r(P,null,S(c(N),s=>(l(),r("option",{key:s.id,value:s.id},i(s.name),9,Ge))),128))],544),[[Y,k.value]]),t[13]||(t[13]=e("label",{for:"subcatSelect"},"Select Subcategory:",-1)),F(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>M.value=s),id:"subcatSelect",required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm width400px"},[t[11]||(t[11]=e("option",{value:"null",disabled:""}," Choose subcategory",-1)),(l(!0),r(P,null,S(c(h),s=>(l(),r("option",{key:s.id,value:s.id},i(s.name),9,Je))),128))],512),[[Y,M.value]]),t[14]||(t[14]=e("button",{type:"submit",class:"mt-3 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none width400px"}," View Products By category and Subcategory",-1))],32)])]),t[19]||(t[19]=e("div",{class:"fullwidth mt-2 floatleft"},[e("hr",{class:"hr1"})],-1)),e("div",Ke,[e("div",We,[e("form",{onSubmit:O(Q,["prevent"])},[F(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>n.value=s),placeholder:"Search products...",onInput:de,class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:border-indigo-500 sm:text-sm width400px"},null,544),[[te,n.value]]),t[16]||(t[16]=e("button",{type:"submit",class:"mt-3 block px-3 py-2 border border-gray-300 rounded-md focus:outline-none width400px"},"Search",-1))],32),y.value.length?(l(),r("ul",Xe,[(l(!0),r(P,null,S(y.value,s=>(l(),r("li",{key:s.id,onClick:me=>ee(s),class:"cursor"}," › "+i(s.name),9,Ze))),128))])):G("",!0),R.value?(l(),r("span",_e," NO SEARCH "+i(R.value),1)):G("",!0)]),e("div",et,[F(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>n.value=s),placeholder:"Search products directly...",onFocus:le,onInput:ie,class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm width400px"},null,544),[[te,n.value]]),x.value.length?(l(),r("ul",tt,[(l(!0),r(P,null,S(x.value,s=>(l(),r("li",{key:s.id,class:"cursor",onClick:me=>ee(s)}," › "+i(s.name),9,at))),128))])):G("",!0)])]),e("div",st,[t[18]||(t[18]=e("h1",{class:"text-2xl font-bold mb-4"},"View All Products ",-1)),B.value==0?(l(),r("div",ot,[(l(),ae(ce,{prods:c(f),currentPage:c(o),lastPage:c(A),changePage:c(I),pageNumbers:c(j),key:T.value.value},null,8,["prods","currentPage","lastPage","changePage","pageNumbers"])),e("p",null,"Current Route: "+i((d._.provides[se]||d.$route).path),1),e("button",{onClick:_,class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-3"},"Refresh Page")])):(l(),r("div",lt,[C(" search done : By 1) : "+i(n.value)+" 2) "+i(c(H))+" ",1),t[17]||(t[17]=e("br",null,null,-1)),C(" Has seach been made: "+i(B.value)+" ",1),(l(),ae(ge,{prodsx:c(v),currentPagex:c(b),lastPagex:c($),changePagex:c(p),pageNumbersx:c(q),searchx:n.value,key:T.value.value},null,8,["prodsx","currentPagex","lastPagex","changePagex","pageNumbersx","searchx"])),e("p",null,"Current Route: "+i((d._.provides[se]||d.$route).path),1),e("button",{onClick:_,class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-3"},"Refresh Page")]))])]),t[20]||(t[20]=e("footer",{class:"w-full bg-white text-right p-4"},null,-1))])])])}}};export{ft as default};
